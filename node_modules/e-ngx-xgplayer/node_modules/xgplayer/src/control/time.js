import Player from '../player'
import '../style/player/time.scss'

let time = function () {
  let player = this; let util = Player.util
  let format = util.format
  let curtime = util.createDom('xg-time', `<span>${player.currentTime || format(0)}</span><em>${player.duration || format(0)}</em>`, {}, 'xgplayer-time'); let root = player.controls
  root.appendChild(curtime)
  let handle = function () {
    if (player.videoConfig.mediaType !== 'audio' || !player.isProgressMoving || !player.dash) {
      curtime.innerHTML = `<span>${format(player.currentTime || 0)}</span><em>${format(player.duration)}`
    }
  }
  util.on(player, 'durationchange', handle, 'destroy')
  util.on(player, 'timeupdate', handle, 'destroy')
}

export default {
  name: 'time',
  method: time
}