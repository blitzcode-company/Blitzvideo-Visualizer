<app-header (toggleSidebar)="toggleSidebar()"></app-header>
<div class="containerHome" [class.collapsed]="sidebarCollapsed$ | async">
  <div class="sidebar-container"  [class.bottom-mobile]="isMobile" >
    <app-sidebar 
    [collapsed]="!!(sidebarCollapsed$ | async)"
    [class.bottom-mobile]="isMobile"
    [isMobile]="isMobile"
        ></app-sidebar>
  </div>  


  <div class="content-wrapper">
    <div class="playlist-header">
      <h1>
        <mat-icon  class="title-icon">history</mat-icon>
        Historial de reproducción
      </h1>
    
    </div>

    <div *ngIf="loading" class="loading-state">
      <mat-spinner diameter="40"></mat-spinner>
      <p>Cargando historial...</p>
    </div>
  
    <div *ngIf="!loading && videos.length === 0" class="empty-state">
      <mat-icon>history</mat-icon>
      <p>No has visto ningún video aún</p>
    </div>
  
    <div class="videos-list" *ngIf="!loading && videos.length > 0">
      <div 
        *ngFor="let video of videos" 
        class="video-row"
        [routerLink]="['/video', video.video_id]"
      >
        <div class="thumbnail">
          <img 
            [src]="video.miniatura"
            [alt]="video.titulo"
            loading="lazy"
            (error)="onImageError($event)"
          >
          <span class="duration" *ngIf="video.duracion">
            {{ formatDuration(video.duracion) }}
          </span>
        </div>
  
        <div class="video-info">
          <h3 class="title">{{ video.titulo }}</h3>
  
          <div class="channel-line">
            <span class="channel-name">{{ video.canal.nombre }}</span>
            <span class="separator">·</span>
            <span class="views">{{ video.visitas_totales | number }} vistas</span>
            <span class="separator">·</span>
            <span class="date">{{ video.visto_en | tiempo }}</span>
          </div>
  
          <div class="user-line">
            <img 
              [src]="video.user.foto || 'assets/images/user.svg'" 
              class="user-avatar"
              [alt]="video.user.nombre"
            >
            <span class="user-name">{{ video.user.nombre }}</span>
          </div>
        </div>
  
      
      </div>
    </div>
  

  </div>


</div>